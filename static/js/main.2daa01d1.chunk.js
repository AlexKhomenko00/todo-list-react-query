(this["webpackJsonptodo-list-react-query"]=this["webpackJsonptodo-list-react-query"]||[]).push([[0],{24:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(19),o=n.n(a),s=(n(24),n(18)),i=n(28),u=n(8),d=n.n(u),l=n(13),p="keyWcRj2jgf83VPyc",f="https://api.airtable.com/v0/app8Cc6HeK1ZkmFYK/Table%201",j=function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r,c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageParam,r=n?"".concat(f,"?pageSize=2&offset=").concat(n):"".concat(f,"?pageSize=2"),e.prev=2,e.next=5,fetch(r+"&sort%5B0%5D%5Bfield%5D=title",{headers:{Authorization:"Bearer ".concat(p)}});case 5:if((c=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,c.json();case 10:throw e.t1=e.sent,new e.t0(e.t1);case 12:return e.next=14,c.json();case 14:return a=e.sent,e.abrupt("return",a);case 18:throw e.prev=18,e.t2=e.catch(2),console.log(e.t2),e.t2;case 22:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(f,{method:"POST",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({fields:{title:t}})});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(l.a)(d.a.mark((function e(t,n){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(f+"/".concat(t),{method:"PATCH",headers:{Authorization:"Bearer ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({fields:{completed:n}})});case 3:return r=e.sent,e.next=6,r.json();case 6:return c=e.sent,e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(l.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(f+"/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(p)}});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),O=n(14),v=n(30),m=n(3),g=function(e){var t=e.todo,n=Object(O.b)(),r=Object(v.a)((function(){return b(t.id,!t.fields.completed)}),{onMutate:function(){var e=n.getQueryData("todos");return n.setQueryData("todos",e),e},onSuccess:function(){n.invalidateQueries("todos")},onError:function(e){n.setQueriesData("tods",e)}}).mutateAsync,c=Object(v.a)((function(){return x(t.id)}),{onSuccess:function(){n.invalidateQueries("todos")}}),a=c.mutateAsync,o=c.isLoading;return Object(m.jsxs)("li",{className:"todo-item",children:[Object(m.jsx)("label",{htmlFor:"".concat(t.id),children:t.fields.title}),Object(m.jsx)("input",{type:"checkbox",onChange:function(){return r()},defaultChecked:t.fields.completed,name:"completed",id:"".concat(t.id)}),Object(m.jsx)("button",{disabled:o,onClick:function(){return a()},children:"Delete task"})]})},y=function(e){var t=e.todos,n=e.onNextPage,r=e.hasNextPage;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("ul",{children:t.map((function(e){return Object(m.jsx)(g,{todo:e},e.id)}))}),Object(m.jsx)("button",{onClick:function(){return n()},disabled:!r,children:r?"Load more todos":"No more to load"})]})},w=function(){var e=Object(r.useRef)(null),t=Object(O.b)(),n=Object(v.a)(h,{onSuccess:function(){return t.invalidateQueries("todos")}}),c=n.mutateAsync,a=n.isLoading;n.isError,n.error;return Object(m.jsxs)("form",{onSubmit:function(t){t.preventDefault(),c(e.current.value),e.current.value=""},children:[Object(m.jsx)("label",{htmlFor:"addTodo",children:"Enter new todo"}),Object(m.jsx)("input",{type:"text",ref:e,id:"addTodo"}),Object(m.jsx)("button",{type:"submit",disabled:a,children:a?"Processing...":"Add Todo"})]})},k=function(){var e=Object(i.a)("todos",j,{getNextPageParam:function(e){return e.offset}}),t=e.data,n=e.isLoading,r=e.isError,c=e.fetchNextPage,a=e.hasNextPage;if(n)return Object(m.jsx)("div",{className:"loading",children:Object(m.jsx)("p",{children:"Loading..."})});if(r)return Object(m.jsx)("div",{className:"error",children:Object(m.jsx)("p",{children:"Oops...something went worng. Please try again later"})});var o=t?t.pages.reduce((function(e,t){return[].concat(Object(s.a)(e),Object(s.a)(t.records))}),[]):[];return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(w,{}),Object(m.jsx)(y,{todos:o,onNextPage:c,hasNextPage:a})]})},N=new(n(29).a);o.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(O.a,{client:N,children:Object(m.jsx)(k,{})})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.2daa01d1.chunk.js.map